# streamlabs_vulnerability
A hackerone report.
# Origins:
Recently, I wanted to start streaming programming lessons, so I searched for a good streaming platform and found Streamlabs. It had a colorful and intuitive UI.
While signing up with YouTube, I noticed that Streamlabs was asking for full YouTube access (This scope: https://www.googleapis.com/auth/youtube), so I canceled and registered with another gmail.
I decompiled the Streamlabs Android app and searched for possible endpoints. Finally, I opened the app and turned on the interceptor (mitmproxy) and the first requests I saw were  exposing all the tokens and data of the user.
The problem is that by Google Dorking and brutforcing those tokens, I got approximately 10 of them in less than an hour.

# Summary:
Through this vulnerability the attacker will have the privilege to stream or upload videos to the victim's channel without authorization.
Affected platforms:
YouTube (Upload videos and stream key access)
Twitch (Stream key access)
Mixer (Stream key access)
Facebook (Stream key access)
Periscope (Stream key access)

# Steps To Reproduce:
It is relatively easy to reproduce this vulnerability by following the next steps:

  1. Open the an android emulator with Android 6.0 API Level 23, for example, Android Studio AVD Manager.
  2. Launch mitmproxy listening on port 8080 (default).
  3. Connect to the proxy from the emulator.
  4. Go to mitm.it from the android emulator' browser.
  5. Install the certificate.
  6. Open the Streamlabs app.
  7. See the http history in mitmproxy and look for this api endpoint: https://streamlabs.com/api/v5/slobs/mobile/user/*token*
  8. Then, the attacker can make a script that automates youtube video upload using the YouTube access_token that was returned by Streamlabs.
  9. To get someone else's token, a bruteforce attack to this api endpoint can be made, also by Google Dorking.
