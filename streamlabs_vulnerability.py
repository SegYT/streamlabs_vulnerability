import requests
import pyfiglet
import json

banner = pyfiglet.figlet_format("StreamerBruh")

print(banner)print("=======> Coded by DimonDev\n")

token = input("[?] Input the Streamlabs token > ")

r1 = requests.get("https://streamlabs.com/api/v1/rst/user/settings?token=" + token) # to get the stream key
r2 = requests.get("https://streamlabs.com/api/v1/rst/ingest?token=" + token) # to get the rtmp server
r3 = requests.get("https://streamlabs.com/api/v5/slobs/mobile/user/" + token) # to get the youtube access token
print(r1.text)

# metadata of the video
dat = {
  'part': 'snippet',
  'snippet.title': 'Нужно поговорить! Это важно!',
  'snippet.description': 'Discord: DimonDev#8813 Telegram: https//t.me/dimondevchat'
}

tokenyt = json.loads(str(r3.text)) # pretty print youtube token
auth = str(tokenyt["youtube_account"]["access_token"])
print(auth)

# headers needed to upload video
head = {
    'Content-Type': 'application/octet-stream', 'Authorization': f"Bearer {str(auth)}"
}

# read the bytes of the video
video = open('1.mp4', 'rb').read()

# upload the video to youtube with the extracted access token 
r4 = requests.post("https://www.googleapis.com/upload/youtube/v3/videos?part=snippet", headers=head, json=dat, data=video)
resp = json.loads(str(r4.text))

# pretty print the request result
server = json.loads(str(r2.text))
streamKey = json.loads(str(r1.text))

# print all the necessary data
print(f'\n┏ Results:\n┣ server: {server["server"]}\n┣ Stream Key: {streamKey["streamKey"]}')
print("┗[*] Done! Now input the values into OBS to Stream some polish cow, bruh!\n")
print(r3.text)
print("\n")
print(r4.text)
print("\n")
print("Done! Quitting...")
